<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>reveal-md</title>
        <link rel="stylesheet" href="./css/reveal.css">
        <link rel="stylesheet" href="https://keetraxx.github.io/pitc-revealjs-theme/puzzle.css" id="theme">
        <link rel="stylesheet" href="./css/highlight/zenburn.css">
        <link rel="stylesheet" href="./css/print/paper.css" type="text/css" media="print">


    </head>
    <body>

        <div class="reveal">
            <div class="slides"><section  data-markdown><script type="text/template"># Openshift Workshop: Template Exercises

<small>tran@puzzle.ch</small>

<!-- .slide: class="master01" -->
</script></section><section  data-markdown><script type="text/template">
## Exercise 1: List all templates provided by the openshift platform

`oc get templates -n openshift`

Those templates are the same as you can see on the web console.
An Openshift Cluster-Admin can add new templates to the **openshift** namespace.
</script></section><section  data-markdown><script type="text/template">
## Exercise 2: Show template parameters

`oc process openshift//postgresql-ephemeral --parameters`

This shows all possible parameters for this template and its default values.
</script></section><section  data-markdown><script type="text/template">
## Exercise 2a: Compare with another template

`oc process openshift//postgresql-persistent --parameters`
</script></section><section  data-markdown><script type="text/template">
## Exercise 3: Display a processed template

`oc process openshift//postgresql-ephemeral -p POSTGRESQL_USER=user -p POSTGRESQL_PASSWORD=pass`

Use this to do *"dry-run"* and analyze what Openshift would create.
</script></section><section  data-markdown><script type="text/template">
## Exercise 4: Create objects using `oc create -f -`

`oc process openshift//postgresql-ephemeral -p POSTGRESQL_USER=user -p POSTGRESQL_PASSWORD=pass | oc create -f -`
</script></section><section  data-markdown><script type="text/template">
## Exercise 5: Create objects using `oc new-app --template=...`

`oc new-app --template=postgresql-ephemeral --param POSTGRESQL_USER=user --param POSTGRESQL_PASSWORD=pass --param DATABASE_SERVICE_NAME=postgres-by-new-app`
</script></section><section ><section data-markdown><script type="text/template">
## Exercise 6: Make your own template

Clean up your project (`oc delete all --all`)

`oc new-app https://github.com/tran-engineering/openshift-workshop-nodejs-example.git --name=myapp HELLO_MSG="Thanks for all the fish"`

`oc export --raw svc,dc,bc,is -l app=myapp -o yaml --as-template=myapp-template > myapp-template.yaml`
</script></section><section data-markdown><script type="text/template">
## Try to make HELLO_MSG configurable as template parameter

Add a parameter to your template:

```yaml
parameters:
  - name: MESSAGE
    displayName: Custom message
    description: Custom message shown on an REQUEST
    value: Hello, this is a default value.
    required: false
```
</script></section><section data-markdown><script type="text/template">
Replace the ENV variable:

```yaml
[...]
        - env:
          - name: HELLO_MSG
            value: ${MESSAGE}
[...]
```
</script></section><section data-markdown><script type="text/template">
Cleanup your current project:

`oc delete all --all`
</script></section><section data-markdown><script type="text/template">
## Double check your template

Check to see if the parameters block is working:
`oc process -f myapp-template.yaml --parameters`

Check to see if the parameters are set:
`oc process -f myapp-template.yaml -p MESSAGE="This message is set by a template parameter" | grep -C 5 HELLO_MSG`
</script></section><section data-markdown><script type="text/template">
## Rebuild it using template:

`oc process -f myapp-template.yaml -p MESSAGE="This message is set by a template parameter" | oc create -f -`

Manually start a build (builds aren't triggered on import):

`oc start-build myapp`
</script></section></section><section ><section data-markdown><script type="text/template">
## Exercise 7: Have a look at other templates

* django-psql-example
* dotnet-example
* mariadb-ephemeral
* mongodb-ephemeral
* mysql-ephemeral
* nodejs-mongodb-example
* postgresql-ephemeral
* rails-postgresql-example
</script></section><section data-markdown><script type="text/template">
Look at template parameters:

`oc process openshift//django-psql-example --parameters`

Create the resources:

`oc process openshift//django-psql-example | oc create -f`

or shorthand

`oc new-app --template=django-psql-example`

</script></section></section></div>
        </div>

        <script src="./lib/js/head.min.js"></script>
        <script src="./js/reveal.js"></script>

        <script>
            function extend() {
              var target = {};
              for (var i = 0; i < arguments.length; i++) {
                var source = arguments[i];
                for (var key in source) {
                  if (source.hasOwnProperty(key)) {
                    target[key] = source[key];
                  }
                }
              }
              return target;
            }

            // Optional libraries used to extend on reveal.js
            var deps = [
              { src: './lib/js/classList.js', condition: function() { return !document.body.classList; } },
              { src: './plugin/markdown/marked.js', condition: function() { return !!document.querySelector('[data-markdown]'); } },
              { src: './plugin/markdown/markdown.js', condition: function() { return !!document.querySelector('[data-markdown]'); } },
              { src: './plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
              { src: './plugin/zoom-js/zoom.js', async: true },
              { src: './plugin/notes/notes.js', async: true },
              { src: './plugin/math/math.js', async: true }
            ];

            // default options to init reveal.js
            var defaultOptions = {
              controls: true,
              progress: true,
              history: true,
              center: true,
              transition: 'default', // none/fade/slide/convex/concave/zoom
              dependencies: deps
            };

            // options from URL query string
            var queryOptions = Reveal.getQueryHash() || {};

            var options = {};
            options = extend(defaultOptions, options, queryOptions);
        </script>

          <script src="./assets/src/scripts/code-copy.js"></script>

        <script>
          Reveal.initialize(options);
        </script>
    </body>
</html>
